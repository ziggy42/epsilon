// Copyright 2025 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package epsilon

// Binary opcodes for WebAssembly instructions.
// It uses a uint32 to accommodate both single-byte and multi-byte opcodes.
// See https://webassembly.github.io/spec/core/appendix/index-instructions.html
type Opcode uint32

const (
	Unreachable               Opcode = 0x00
	Nop                       Opcode = 0x01
	Block                     Opcode = 0x02
	Loop                      Opcode = 0x03
	If                        Opcode = 0x04
	Else                      Opcode = 0x05
	End                       Opcode = 0x0B
	Br                        Opcode = 0x0C
	BrIf                      Opcode = 0x0D
	BrTable                   Opcode = 0x0E
	Return                    Opcode = 0x0F
	Call                      Opcode = 0x10
	CallIndirect              Opcode = 0x11
	Drop                      Opcode = 0x1A
	Select                    Opcode = 0x1B
	SelectT                   Opcode = 0x1C
	LocalGet                  Opcode = 0x20
	LocalSet                  Opcode = 0x21
	LocalTee                  Opcode = 0x22
	GlobalGet                 Opcode = 0x23
	GlobalSet                 Opcode = 0x24
	TableGet                  Opcode = 0x25
	TableSet                  Opcode = 0x26
	I32Load                   Opcode = 0x28
	I64Load                   Opcode = 0x29
	F32Load                   Opcode = 0x2A
	F64Load                   Opcode = 0x2B
	I32Load8S                 Opcode = 0x2C
	I32Load8U                 Opcode = 0x2D
	I32Load16S                Opcode = 0x2E
	I32Load16U                Opcode = 0x2F
	I64Load8S                 Opcode = 0x30
	I64Load8U                 Opcode = 0x31
	I64Load16S                Opcode = 0x32
	I64Load16U                Opcode = 0x33
	I64Load32S                Opcode = 0x34
	I64Load32U                Opcode = 0x35
	I32Store                  Opcode = 0x36
	I64Store                  Opcode = 0x37
	F32Store                  Opcode = 0x38
	F64Store                  Opcode = 0x39
	I32Store8                 Opcode = 0x3A
	I32Store16                Opcode = 0x3B
	I64Store8                 Opcode = 0x3C
	I64Store16                Opcode = 0x3D
	I64Store32                Opcode = 0x3E
	MemorySize                Opcode = 0x3F
	MemoryGrow                Opcode = 0x40
	I32Const                  Opcode = 0x41
	I64Const                  Opcode = 0x42
	F32Const                  Opcode = 0x43
	F64Const                  Opcode = 0x44
	I32Eqz                    Opcode = 0x45
	I32Eq                     Opcode = 0x46
	I32Ne                     Opcode = 0x47
	I32LtS                    Opcode = 0x48
	I32LtU                    Opcode = 0x49
	I32GtS                    Opcode = 0x4A
	I32GtU                    Opcode = 0x4B
	I32LeS                    Opcode = 0x4C
	I32LeU                    Opcode = 0x4D
	I32GeS                    Opcode = 0x4E
	I32GeU                    Opcode = 0x4F
	I64Eqz                    Opcode = 0x50
	I64Eq                     Opcode = 0x51
	I64Ne                     Opcode = 0x52
	I64LtS                    Opcode = 0x53
	I64LtU                    Opcode = 0x54
	I64GtS                    Opcode = 0x55
	I64GtU                    Opcode = 0x56
	I64LeS                    Opcode = 0x57
	I64LeU                    Opcode = 0x58
	I64GeS                    Opcode = 0x59
	I64GeU                    Opcode = 0x5A
	F32Eq                     Opcode = 0x5B
	F32Ne                     Opcode = 0x5C
	F32Lt                     Opcode = 0x5D
	F32Gt                     Opcode = 0x5E
	F32Le                     Opcode = 0x5F
	F32Ge                     Opcode = 0x60
	F64Eq                     Opcode = 0x61
	F64Ne                     Opcode = 0x62
	F64Lt                     Opcode = 0x63
	F64Gt                     Opcode = 0x64
	F64Le                     Opcode = 0x65
	F64Ge                     Opcode = 0x66
	I32Clz                    Opcode = 0x67
	I32Ctz                    Opcode = 0x68
	I32Popcnt                 Opcode = 0x69
	I32Add                    Opcode = 0x6A
	I32Sub                    Opcode = 0x6B
	I32Mul                    Opcode = 0x6C
	I32DivS                   Opcode = 0x6D
	I32DivU                   Opcode = 0x6E
	I32RemS                   Opcode = 0x6F
	I32RemU                   Opcode = 0x70
	I32And                    Opcode = 0x71
	I32Or                     Opcode = 0x72
	I32Xor                    Opcode = 0x73
	I32Shl                    Opcode = 0x74
	I32ShrS                   Opcode = 0x75
	I32ShrU                   Opcode = 0x76
	I32Rotl                   Opcode = 0x77
	I32Rotr                   Opcode = 0x78
	I64Clz                    Opcode = 0x79
	I64Ctz                    Opcode = 0x7A
	I64Popcnt                 Opcode = 0x7B
	I64Add                    Opcode = 0x7C
	I64Sub                    Opcode = 0x7D
	I64Mul                    Opcode = 0x7E
	I64DivS                   Opcode = 0x7F
	I64DivU                   Opcode = 0x80
	I64RemS                   Opcode = 0x81
	I64RemU                   Opcode = 0x82
	I64And                    Opcode = 0x83
	I64Or                     Opcode = 0x84
	I64Xor                    Opcode = 0x85
	I64Shl                    Opcode = 0x86
	I64ShrS                   Opcode = 0x87
	I64ShrU                   Opcode = 0x88
	I64Rotl                   Opcode = 0x89
	I64Rotr                   Opcode = 0x8A
	F32Abs                    Opcode = 0x8B
	F32Neg                    Opcode = 0x8C
	F32Ceil                   Opcode = 0x8D
	F32Floor                  Opcode = 0x8E
	F32Trunc                  Opcode = 0x8F
	F32Nearest                Opcode = 0x90
	F32Sqrt                   Opcode = 0x91
	F32Add                    Opcode = 0x92
	F32Sub                    Opcode = 0x93
	F32Mul                    Opcode = 0x94
	F32Div                    Opcode = 0x95
	F32Min                    Opcode = 0x96
	F32Max                    Opcode = 0x97
	F32Copysign               Opcode = 0x98
	F64Abs                    Opcode = 0x99
	F64Neg                    Opcode = 0x9A
	F64Ceil                   Opcode = 0x9B
	F64Floor                  Opcode = 0x9C
	F64Trunc                  Opcode = 0x9D
	F64Nearest                Opcode = 0x9E
	F64Sqrt                   Opcode = 0x9F
	F64Add                    Opcode = 0xA0
	F64Sub                    Opcode = 0xA1
	F64Mul                    Opcode = 0xA2
	F64Div                    Opcode = 0xA3
	F64Min                    Opcode = 0xA4
	F64Max                    Opcode = 0xA5
	F64Copysign               Opcode = 0xA6
	I32WrapI64                Opcode = 0xA7
	I32TruncF32S              Opcode = 0xA8
	I32TruncF32U              Opcode = 0xA9
	I32TruncF64S              Opcode = 0xAA
	I32TruncF64U              Opcode = 0xAB
	I64ExtendI32S             Opcode = 0xAC
	I64ExtendI32U             Opcode = 0xAD
	I64TruncF32S              Opcode = 0xAE
	I64TruncF32U              Opcode = 0xAF
	I64TruncF64S              Opcode = 0xB0
	I64TruncF64U              Opcode = 0xB1
	F32ConvertI32S            Opcode = 0xB2
	F32ConvertI32U            Opcode = 0xB3
	F32ConvertI64S            Opcode = 0xB4
	F32ConvertI64U            Opcode = 0xB5
	F32DemoteF64              Opcode = 0xB6
	F64ConvertI32S            Opcode = 0xB7
	F64ConvertI32U            Opcode = 0xB8
	F64ConvertI64S            Opcode = 0xB9
	F64ConvertI64U            Opcode = 0xBA
	F64PromoteF32             Opcode = 0xBB
	I32ReinterpretF32         Opcode = 0xBC
	I64ReinterpretF64         Opcode = 0xBD
	F32ReinterpretI32         Opcode = 0xBE
	F64ReinterpretI64         Opcode = 0xBF
	I32Extend8S               Opcode = 0xC0
	I32Extend16S              Opcode = 0xC1
	I64Extend8S               Opcode = 0xC2
	I64Extend16S              Opcode = 0xC3
	I64Extend32S              Opcode = 0xC4
	RefNull                   Opcode = 0xD0
	RefIsNull                 Opcode = 0xD1
	RefFunc                   Opcode = 0xD2
	I32TruncSatF32S           Opcode = 0xFC00
	I32TruncSatF32U           Opcode = 0xFC01
	I32TruncSatF64S           Opcode = 0xFC02
	I32TruncSatF64U           Opcode = 0xFC03
	I64TruncSatF32S           Opcode = 0xFC04
	I64TruncSatF32U           Opcode = 0xFC05
	I64TruncSatF64S           Opcode = 0xFC06
	I64TruncSatF64U           Opcode = 0xFC07
	MemoryInit                Opcode = 0xFC08
	DataDrop                  Opcode = 0xFC09
	MemoryCopy                Opcode = 0xFC0A
	MemoryFill                Opcode = 0xFC0B
	TableInit                 Opcode = 0xFC0C
	ElemDrop                  Opcode = 0xFC0D
	TableCopy                 Opcode = 0xFC0E
	TableGrow                 Opcode = 0xFC0F
	TableSize                 Opcode = 0xFC10
	TableFill                 Opcode = 0xFC11
	V128Load                  Opcode = 0xFD00
	V128Load8x8S              Opcode = 0xFD01
	V128Load8x8U              Opcode = 0xFD02
	V128Load16x4S             Opcode = 0xFD03
	V128Load16x4U             Opcode = 0xFD04
	V128Load32x2S             Opcode = 0xFD05
	V128Load32x2U             Opcode = 0xFD06
	V128Load8Splat            Opcode = 0xFD07
	V128Load16Splat           Opcode = 0xFD08
	V128Load32Splat           Opcode = 0xFD09
	V128Load64Splat           Opcode = 0xFD0A
	V128Store                 Opcode = 0xFD0B
	V128Const                 Opcode = 0xFD0C
	I8x16Shuffle              Opcode = 0xFD0D
	I8x16Swizzle              Opcode = 0xFD0E
	I8x16Splat                Opcode = 0xFD0F
	I16x8Splat                Opcode = 0xFD10
	I32x4Splat                Opcode = 0xFD11
	I64x2Splat                Opcode = 0xFD12
	F32x4Splat                Opcode = 0xFD13
	F64x2Splat                Opcode = 0xFD14
	I8x16ExtractLaneS         Opcode = 0xFD15
	I8x16ExtractLaneU         Opcode = 0xFD16
	I8x16ReplaceLane          Opcode = 0xFD17
	I16x8ExtractLaneS         Opcode = 0xFD18
	I16x8ExtractLaneU         Opcode = 0xFD19
	I16x8ReplaceLane          Opcode = 0xFD1A
	I32x4ExtractLane          Opcode = 0xFD1B
	I32x4ReplaceLane          Opcode = 0xFD1C
	I64x2ExtractLane          Opcode = 0xFD1D
	I64x2ReplaceLane          Opcode = 0xFD1E
	F32x4ExtractLane          Opcode = 0xFD1F
	F32x4ReplaceLane          Opcode = 0xFD20
	F64x2ExtractLane          Opcode = 0xFD21
	F64x2ReplaceLane          Opcode = 0xFD22
	I8x16Eq                   Opcode = 0xFD23
	I8x16Ne                   Opcode = 0xFD24
	I8x16LtS                  Opcode = 0xFD25
	I8x16LtU                  Opcode = 0xFD26
	I8x16GtS                  Opcode = 0xFD27
	I8x16GtU                  Opcode = 0xFD28
	I8x16LeS                  Opcode = 0xFD29
	I8x16LeU                  Opcode = 0xFD2A
	I8x16GeS                  Opcode = 0xFD2B
	I8x16GeU                  Opcode = 0xFD2C
	I16x8Eq                   Opcode = 0xFD2D
	I16x8Ne                   Opcode = 0xFD2E
	I16x8LtS                  Opcode = 0xFD2F
	I16x8LtU                  Opcode = 0xFD30
	I16x8GtS                  Opcode = 0xFD31
	I16x8GtU                  Opcode = 0xFD32
	I16x8LeS                  Opcode = 0xFD33
	I16x8LeU                  Opcode = 0xFD34
	I16x8GeS                  Opcode = 0xFD35
	I16x8GeU                  Opcode = 0xFD36
	I32x4Eq                   Opcode = 0xFD37
	I32x4Ne                   Opcode = 0xFD38
	I32x4LtS                  Opcode = 0xFD39
	I32x4LtU                  Opcode = 0xFD3A
	I32x4GtS                  Opcode = 0xFD3B
	I32x4GtU                  Opcode = 0xFD3C
	I32x4LeS                  Opcode = 0xFD3D
	I32x4LeU                  Opcode = 0xFD3E
	I32x4GeS                  Opcode = 0xFD3F
	I32x4GeU                  Opcode = 0xFD40
	F32x4Eq                   Opcode = 0xFD41
	F32x4Ne                   Opcode = 0xFD42
	F32x4Lt                   Opcode = 0xFD43
	F32x4Gt                   Opcode = 0xFD44
	F32x4Le                   Opcode = 0xFD45
	F32x4Ge                   Opcode = 0xFD46
	F64x2Eq                   Opcode = 0xFD47
	F64x2Ne                   Opcode = 0xFD48
	F64x2Lt                   Opcode = 0xFD49
	F64x2Gt                   Opcode = 0xFD4A
	F64x2Le                   Opcode = 0xFD4B
	F64x2Ge                   Opcode = 0xFD4C
	V128Not                   Opcode = 0xFD4D
	V128And                   Opcode = 0xFD4E
	V128Andnot                Opcode = 0xFD4F
	V128Or                    Opcode = 0xFD50
	V128Xor                   Opcode = 0xFD51
	V128Bitselect             Opcode = 0xFD52
	V128AnyTrue               Opcode = 0xFD53
	V128Load8Lane             Opcode = 0xFD54
	V128Load16Lane            Opcode = 0xFD55
	V128Load32Lane            Opcode = 0xFD56
	V128Load64Lane            Opcode = 0xFD57
	V128Store8Lane            Opcode = 0xFD58
	V128Store16Lane           Opcode = 0xFD59
	V128Store32Lane           Opcode = 0xFD5A
	V128Store64Lane           Opcode = 0xFD5B
	V128Load32Zero            Opcode = 0xFD5C
	V128Load64Zero            Opcode = 0xFD5D
	F32x4DemoteF64x2Zero      Opcode = 0xFD5E
	F64x2PromoteLowF32x4      Opcode = 0xFD5F
	I8x16Abs                  Opcode = 0xFD60
	I8x16Neg                  Opcode = 0xFD61
	I8x16Popcnt               Opcode = 0xFD62
	I8x16AllTrue              Opcode = 0xFD63
	I8x16Bitmask              Opcode = 0xFD64
	I8x16NarrowI16x8S         Opcode = 0xFD65
	I8x16NarrowI16x8U         Opcode = 0xFD66
	F32x4Ceil                 Opcode = 0xFD67
	F32x4Floor                Opcode = 0xFD68
	F32x4Trunc                Opcode = 0xFD69
	F32x4Nearest              Opcode = 0xFD6A
	I8x16Shl                  Opcode = 0xFD6B
	I8x16ShrS                 Opcode = 0xFD6C
	I8x16ShrU                 Opcode = 0xFD6D
	I8x16Add                  Opcode = 0xFD6E
	I8x16AddSatS              Opcode = 0xFD6F
	I8x16AddSatU              Opcode = 0xFD70
	I8x16Sub                  Opcode = 0xFD71
	I8x16SubSatS              Opcode = 0xFD72
	I8x16SubSatU              Opcode = 0xFD73
	F64x2Ceil                 Opcode = 0xFD74
	F64x2Floor                Opcode = 0xFD75
	I8x16MinS                 Opcode = 0xFD76
	I8x16MinU                 Opcode = 0xFD77
	I8x16MaxS                 Opcode = 0xFD78
	I8x16MaxU                 Opcode = 0xFD79
	F64x2Trunc                Opcode = 0xFD7A
	I8x16AvgrU                Opcode = 0xFD7B
	I16x8ExtaddPairwiseI8x16S Opcode = 0xFD7C
	I16x8ExtaddPairwiseI8x16U Opcode = 0xFD7D
	I32x4ExtaddPairwiseI16x8S Opcode = 0xFD7E
	I32x4ExtaddPairwiseI16x8U Opcode = 0xFD7F
	I16x8Abs                  Opcode = 0xFD80
	I16x8Neg                  Opcode = 0xFD81
	I16x8Q15mulrSatS          Opcode = 0xFD82
	I16x8AllTrue              Opcode = 0xFD83
	I16x8Bitmask              Opcode = 0xFD84
	I16x8NarrowI32x4S         Opcode = 0xFD85
	I16x8NarrowI32x4U         Opcode = 0xFD86
	I16x8ExtendLowI8x16S      Opcode = 0xFD87
	I16x8ExtendHighI8x16S     Opcode = 0xFD88
	I16x8ExtendLowI8x16U      Opcode = 0xFD89
	I16x8ExtendHighI8x16U     Opcode = 0xFD8A
	I16x8Shl                  Opcode = 0xFD8B
	I16x8ShrS                 Opcode = 0xFD8C
	I16x8ShrU                 Opcode = 0xFD8D
	I16x8Add                  Opcode = 0xFD8E
	I16x8AddSatS              Opcode = 0xFD8F
	I16x8AddSatU              Opcode = 0xFD90
	I16x8Sub                  Opcode = 0xFD91
	I16x8SubSatS              Opcode = 0xFD92
	I16x8SubSatU              Opcode = 0xFD93
	F64x2Nearest              Opcode = 0xFD94
	I16x8Mul                  Opcode = 0xFD95
	I16x8MinS                 Opcode = 0xFD96
	I16x8MinU                 Opcode = 0xFD97
	I16x8MaxS                 Opcode = 0xFD98
	I16x8MaxU                 Opcode = 0xFD99
	I16x8AvgrU                Opcode = 0xFD9B
	I16x8ExtmulLowI8x16S      Opcode = 0xFD9C
	I16x8ExtmulHighI8x16S     Opcode = 0xFD9D
	I16x8ExtmulLowI8x16U      Opcode = 0xFD9E
	I16x8ExtmulHighI8x16U     Opcode = 0xFD9F
	I32x4Abs                  Opcode = 0xFDA0
	I32x4Neg                  Opcode = 0xFDA1
	I32x4AllTrue              Opcode = 0xFDA3
	I32x4Bitmask              Opcode = 0xFDA4
	I32x4ExtendLowI16x8S      Opcode = 0xFDA7
	I32x4ExtendHighI16x8S     Opcode = 0xFDA8
	I32x4ExtendLowI16x8U      Opcode = 0xFDA9
	I32x4ExtendHighI16x8U     Opcode = 0xFDAA
	I32x4Shl                  Opcode = 0xFDAB
	I32x4ShrS                 Opcode = 0xFDAC
	I32x4ShrU                 Opcode = 0xFDAD
	I32x4Add                  Opcode = 0xFDAE
	I32x4Sub                  Opcode = 0xFDB1
	I32x4Mul                  Opcode = 0xFDB5
	I32x4MinS                 Opcode = 0xFDB6
	I32x4MinU                 Opcode = 0xFDB7
	I32x4MaxS                 Opcode = 0xFDB8
	I32x4MaxU                 Opcode = 0xFDB9
	I32x4DotI16x8S            Opcode = 0xFDBA
	I32x4ExtmulLowI16x8S      Opcode = 0xFDBC
	I32x4ExtmulHighI16x8S     Opcode = 0xFDBD
	I32x4ExtmulLowI16x8U      Opcode = 0xFDBE
	I32x4ExtmulHighI16x8U     Opcode = 0xFDBF
	I64x2Abs                  Opcode = 0xFDC0
	I64x2Neg                  Opcode = 0xFDC1
	I64x2AllTrue              Opcode = 0xFDC3
	I64x2Bitmask              Opcode = 0xFDC4
	I64x2ExtendLowI32x4S      Opcode = 0xFDC7
	I64x2ExtendHighI32x4S     Opcode = 0xFDC8
	I64x2ExtendLowI32x4U      Opcode = 0xFDC9
	I64x2ExtendHighI32x4U     Opcode = 0xFDCA
	I64x2Shl                  Opcode = 0xFDCB
	I64x2ShrS                 Opcode = 0xFDCC
	I64x2ShrU                 Opcode = 0xFDCD
	I64x2Add                  Opcode = 0xFDCE
	I64x2Sub                  Opcode = 0xFDD1
	I64x2Mul                  Opcode = 0xFDD5
	I64x2Eq                   Opcode = 0xFDD6
	I64x2Ne                   Opcode = 0xFDD7
	I64x2LtS                  Opcode = 0xFDD8
	I64x2GtS                  Opcode = 0xFDD9
	I64x2LeS                  Opcode = 0xFDDA
	I64x2GeS                  Opcode = 0xFDDB
	I64x2ExtmulLowI32x4S      Opcode = 0xFDDC
	I64x2ExtmulHighI32x4S     Opcode = 0xFDDD
	I64x2ExtmulLowI32x4U      Opcode = 0xFDDE
	I64x2ExtmulHighI32x4U     Opcode = 0xFDDF
	F32x4Abs                  Opcode = 0xFDE0
	F32x4Neg                  Opcode = 0xFDE1
	F32x4Sqrt                 Opcode = 0xFDE3
	F32x4Add                  Opcode = 0xFDE4
	F32x4Sub                  Opcode = 0xFDE5
	F32x4Mul                  Opcode = 0xFDE6
	F32x4Div                  Opcode = 0xFDE7
	F32x4Min                  Opcode = 0xFDE8
	F32x4Max                  Opcode = 0xFDE9
	F32x4Pmin                 Opcode = 0xFDEA
	F32x4Pmax                 Opcode = 0xFDEB
	F64x2Abs                  Opcode = 0xFDEC
	F64x2Neg                  Opcode = 0xFDED
	F64x2Sqrt                 Opcode = 0xFDEF
	F64x2Add                  Opcode = 0xFDF0
	F64x2Sub                  Opcode = 0xFDF1
	F64x2Mul                  Opcode = 0xFDF2
	F64x2Div                  Opcode = 0xFDF3
	F64x2Min                  Opcode = 0xFDF4
	F64x2Max                  Opcode = 0xFDF5
	F64x2Pmin                 Opcode = 0xFDF6
	F64x2Pmax                 Opcode = 0xFDF7
	I32x4TruncSatF32x4S       Opcode = 0xFDF8
	I32x4TruncSatF32x4U       Opcode = 0xFDF9
	F32x4ConvertI32x4S        Opcode = 0xFDFA
	F32x4ConvertI32x4U        Opcode = 0xFDFB
	I32x4TruncSatF64x2SZero   Opcode = 0xFDFC
	I32x4TruncSatF64x2UZero   Opcode = 0xFDFD
	F64x2ConvertLowI32x4S     Opcode = 0xFDFE
	F64x2ConvertLowI32x4U     Opcode = 0xFDFF
)

// Instruction represents a single decoded WASM instruction.
type Instruction struct {
	Opcode     Opcode
	Immediates []uint64
}
